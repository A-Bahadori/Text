public static class AsposeHelper
{
    private static bool _isLicenseSet = false;
    private static readonly object _lockObject = new object();

    public static void SetLicense()
    {
        if (_isLicenseSet) return;

        lock (_lockObject)
        {
            if (_isLicenseSet) return;

            try
            {
                var wordLicense = new Aspose.Words.License();
                
                // روش اول: از فایل خارجی
                string licensePath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, 
                    "Licenses", "Aspose.Total.NET.lic");
                
                if (File.Exists(licensePath))
                {
                    wordLicense.SetLicense(licensePath);
                    _isLicenseSet = true;
                    return;
                }

                // روش دوم: از Embedded Resource
                wordLicense.SetLicense("YourNamespace.Aspose.Total.NET.lic");
                _isLicenseSet = true;
            }
            catch (Exception ex)
            {
                throw new InvalidOperationException($"Failed to set Aspose license: {ex.Message}", ex);
            }
        }
    }
}
