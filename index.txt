using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

namespace EmojiSelectorApp
{
    public partial class MainForm : Form
    {
        private TextBox txtMessage;
        private Button btnEmoji;
        private Panel emojiPanel;
        private List<string> emojis;

        public MainForm()
        {
            InitializeComponent();
            InitializeEmojiList();
            SetupControls();
        }

        private void InitializeEmojiList()
        {
            // لیستی از اموجی‌های پرکاربرد
            emojis = new List<string>()
            {
                "😀", "😁", "😂", "🤣", "😃", "😄", "😅", "😆",
                "😉", "😊", "😋", "😎", "😍", "😘", "🥰", "😗",
                "😙", "😚", "🙂", "🤗", "🤩", "🤔", "🤨", "😐",
                "😑", "😶", "🙄", "😏", "😣", "😥", "😮", "🤐",
                "😯", "😪", "😫", "🥱", "😴", "😌", "😛", "😜",
                "😝", "🤤", "😒", "😓", "😔", "😕", "🙃", "🤑",
                "😲", "☹️", "🙁", "😖", "😞", "😟", "😤", "😢",
                "😭", "😦", "😧", "😨", "😩", "🤯", "😬", "😰"
            };
        }

        private void SetupControls()
        {
            // تنظیم فرم اصلی
            this.Text = "پیام‌رسان با انتخابگر اموجی";
            this.Size = new Size(500, 400);
            this.StartPosition = FormStartPosition.CenterScreen;
            
            // ایجاد TextBox برای نوشتن پیام
            txtMessage = new TextBox
            {
                Multiline = true,
                Location = new Point(10, 10),
                Size = new Size(400, 100),
                Font = new Font("Segoe UI", 12),
                RightToLeft = RightToLeft.Yes // برای پشتیبانی از زبان فارسی
            };
            this.Controls.Add(txtMessage);
            
            // ایجاد دکمه برای نمایش پنل اموجی
            btnEmoji = new Button
            {
                Text = "😊",
                Location = new Point(420, 10),
                Size = new Size(50, 50),
                Font = new Font("Segoe UI", 16)
            };
            btnEmoji.Click += BtnEmoji_Click;
            this.Controls.Add(btnEmoji);
            
            // ایجاد پنل برای نمایش اموجی‌ها
            emojiPanel = new Panel
            {
                Location = new Point(10, 120),
                Size = new Size(460, 200),
                BorderStyle = BorderStyle.FixedSingle,
                Visible = false,
                AutoScroll = true
            };
            this.Controls.Add(emojiPanel);
            
            // پر کردن پنل با دکمه‌های اموجی
            CreateEmojiButtons();
        }

        private void CreateEmojiButtons()
        {
            int buttonSize = 40;
            int buttonsPerRow = 10;
            int xPos = 5;
            int yPos = 5;
            int index = 0;
            
            foreach (string emoji in emojis)
            {
                Button btnEmoji = new Button
                {
                    Text = emoji,
                    Size = new Size(buttonSize, buttonSize),
                    Location = new Point(xPos, yPos),
                    Font = new Font("Segoe UI", 12),
                    FlatStyle = FlatStyle.Flat
                };
                
                btnEmoji.Click += EmojiButton_Click;
                emojiPanel.Controls.Add(btnEmoji);
                
                index++;
                if (index % buttonsPerRow == 0)
                {
                    xPos = 5;
                    yPos += buttonSize + 5;
                }
                else
                {
                    xPos += buttonSize + 5;
                }
            }
        }

        private void BtnEmoji_Click(object sender, EventArgs e)
        {
            // نمایش یا مخفی کردن پنل اموجی
            emojiPanel.Visible = !emojiPanel.Visible;
        }

        private void EmojiButton_Click(object sender, EventArgs e)
        {
            Button btnClicked = sender as Button;
            string selectedEmoji = btnClicked.Text;
            
            // اضافه کردن اموجی انتخاب شده به موقعیت فعلی کرسر
            int cursorPosition = txtMessage.SelectionStart;
            txtMessage.Text = txtMessage.Text.Insert(cursorPosition, selectedEmoji);
            txtMessage.SelectionStart = cursorPosition + selectedEmoji.Length;
            
            // تمرکز دوباره روی TextBox
            txtMessage.Focus();
        }

        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new MainForm());
        }
    }
}
